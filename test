@echo off
setlocal EnableExtensions DisableDelayedExpansion

:: Check if already running as admin
fltmc >nul 2>&1 || (
    echo Requesting administrator privileges...
    PowerShell Start-Process -FilePath "%~f0" -Verb RunAs -ArgumentList "-silent"
    exit /b
)

:: Check current edition
for /f "tokens=3 delims=: " %%a in ('DISM /English /Online /Get-CurrentEdition 2^>nul ^| find /i "Current Edition :"') do set "osedition=%%a"

:: If already Pro, exit
if /i "%osedition%"=="Professional" exit /b

:: If not Pro, activate with Pro key
set "pro_key=VK7JG-NPHTM-C97JM-9MPGT-3V66T"

:: Activate silently
DISM /online /Set-Edition:Professional /ProductKey:%pro_key% /AcceptEula >nul 2>&1

:: If DISM fails, try alternative method
if %errorlevel% neq 0 (
    cscript //nologo %SystemRoot%\System32\slmgr.vbs /ipk %pro_key% >nul 2>&1
    cscript //nologo %SystemRoot%\System32\slmgr.vbs /ato >nul 2>&1
)

exit /b
